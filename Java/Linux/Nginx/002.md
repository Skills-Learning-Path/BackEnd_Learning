# Nginx使用

## Nginx常用命令

1.  使用nginx命令的前提条件: 进入nginx目录`cd /usr/local/nginx/sbin`

2.  查看nginx的版本号

    `./nginx -v`

    ```bash
     sbin$ ./nginx -v
    nginx version: nginx/1.18.0
    ```

3.  启动Nginx

    `/nginx `

    ```bash
     sbin$ sudo ./nginx 
    ```

4.  停止Nginx

    `./nginx -s stop`

    ```bash
     sbin$ sudo ./nginx -s stop
    ```

5.  重新加载Nginx

    `./nginx -s reload`

    ```bash
     sbin$ sudo ./nginx -s reload
    ```

## Nginx配置文件

1.  nginx 配置文件的位置`/usr/local/nginx/conf/nginx.conf`

2.  配置文件的组成

    -   第一部分 全局块

        从配置文件开始到 events块之间的内容，主要设置一些影响nginx服务器整体运行的配置指令

        ```bash
        #user  nobody;
        worker_processes  1;
        #error_log  logs/error.log;
        #error_log  logs/error.log  notice;
        #error_log  logs/error.log  info;
        #pid        logs/nginx.pid;
        ```

        worker_processes  1;  值越大，可以支持的并发处理量就越多

    -   第二部分 events块

        events块涉及的指令主要是 ：用户与nginx服务器之间的网络连接

        ```bash
        events {
            worker_connections  1024;
        }
        ```

        worker_connections  1024; 支持的最大连接数

    -   第三部分 http块

        1.  http 全局块

            文件引入、MIME-TYPE定义、日志自定义、连接超时时间、单链接请求数上限等

            ```bash
            	include       mime.types;
                default_type  application/octet-stream;
                #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                #                  '$status $body_bytes_sent "$http_referer" '
                #                  '"$http_user_agent" "$http_x_forwarded_for"';
                #access_log  logs/access.log  main;
                sendfile        on;
                #tcp_nopush     on;
                #keepalive_timeout  0;
                keepalive_timeout  65;
                #gzip  on;
            ```

        2.  server块

            与虚拟主机有密切关系

            每个http块可以包含多个server块，而每个server块相当于一个虚拟主机

            每个server块可以分为全局server块，以及可以同时包含多个location块

            -   全局server块

                虚拟主机的监听配置、名称或IP配置

            -   location块

                一个server块可以配置多个location块

                基于Nginx服务器接收到的请求字符串，对虚拟主机名称之外的字符串进行匹配，对特定的请求进行处理。地址定向、数据缓存和应答控制等功能，还有很多第三方模块的配置也在这里进行。

            ```bash
              server {
                    listen       80;
                    server_name  localhost;
                    #charset koi8-r;
                    #access_log  logs/host.access.log  main;
                    location / {
                        root   html;
                        index  index.html index.htm;
                    }
                    #error_page  404              /404.html;
                    # redirect server error pages to the static page /50x.html
                    #
                    error_page   500 502 503 504  /50x.html;
                    location = /50x.html {
                        root   html;
                    }
                    # proxy the PHP scripts to Apache listening on 127.0.0.1:80
                    #
                    #location ~ \.php$ {
                    #    proxy_pass   http://127.0.0.1;
                    #}
                    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
                    #
                    #location ~ \.php$ {
                    #    root           html;
                    #    fastcgi_pass   127.0.0.1:9000;
                    #    fastcgi_index  index.php;
                    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
                    #    include        fastcgi_params;
                    #}
                    # deny access to .htaccess files, if Apache's document root
                    # concurs with nginx's one
                    #
                    #location ~ /\.ht {
                    #    deny  all;
                    #}
                }
                # another virtual host using mix of IP-, name-, and port-based configuration
                #
                #server {
                #    listen       8000;
                #    listen       somename:8080;
                #    server_name  somename  alias  another.alias;
                #    location / {
                #        root   html;
                #        index  index.html index.htm;
                #    }
                #}
                # HTTPS server
                #
                #server {
                #    listen       443 ssl;
                #    server_name  localhost;
                #    ssl_certificate      cert.pem;
                #    ssl_certificate_key  cert.key;
                #    ssl_session_cache    shared:SSL:1m;
                #    ssl_session_timeout  5m;
                #    ssl_ciphers  HIGH:!aNULL:!MD5;
                #    ssl_prefer_server_ciphers  on;
                #    location / {
                #        root   html;
                #        index  index.html index.htm;
                #    }
                #}
            ```

        

## Nginx应用

### Nginx实现反向代理



### Nginx实现负载均衡



### Nginx实现动静分离



### Nginx配置高可用



## Nginx原理



​        